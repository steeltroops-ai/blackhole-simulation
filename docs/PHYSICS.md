# Relativistic Physics Specification

Technical foundations for the **Advanced Event Horizon Engine**. This document details the transition from geometric optics to radiative transfer and spectral rendering.

---

## 1. Metric and Spacetime Geometry

Computations utilize **Geometric Units ($G = c = 1$)**. The engine implements the **Kerr Metric** for a rotating uncharged black hole.

### 1.1 The Kerr Metric Tensor ($g_{\mu\nu}$)

We solve for the spacetime interval in **Boyer-Lindquist coordinates**:

$$
ds^2 = -\left(1 - \frac{2Mr}{\Sigma}\right) dt^2 - \frac{4Mar \sin^2\theta}{\Sigma} dt d\phi + \frac{\Sigma}{\Delta} dr^2 + \Sigma d\theta^2 + \left(r^2 + a^2 + \frac{2Ma^2r \sin^2\theta}{\Sigma}\right) \sin^2\theta d\phi^2
$$

Where:

- $\Sigma = r^2 + a^2 \cos^2\theta$
- $\Delta = r^2 - 2Mr + a^2$

---

## 2. Advanced Path Integration

To achieve scientific precision, we move beyond simple ray-marching to **Symplectic Integration**.

### 2.1 Numerical Stability: Adaptive RKF45 (Cash-Karp)

Instead of a fixed-step Runge-Kutta method, we implement an **Adaptive Runge-Kutta-Fehlberg 4(5)** integrator in the Rust kernel:

- **Precision-Gated**: Uses an embedded 5th-order error estimate to adjust step size $h$ dynamically, maintaining local truncation error below a user-defined tolerance.
- **Horizon Stability**: Automatically shrinks the step size by orders of magnitude near the photon sphere to resolve extreme curvature without numerical breakdown.
- **Conservation**: Integrated with a **Hamiltonian Regularizer** that renormalizes momentum at every step to satisfy $H=0$ for null geodesics.

### 2.2 Curvilinear Polar Sampling (Infinite Resolution)

Instead of sampling texture noise in Cartesian screen space $(x, y)$, we sample in curved spacetime coordinates $(r, \phi - \Omega t)$.

- **Feature**: This produces infinite resolution "streaks" that naturally follow the curvature of the accretion disk.
- **Zoom**: Allows for 1000x zoom levels without pixelation artifacts.

---

## 3. Radiative Transfer & Thermodynamics

We transition from **Geometric Optics** (tracing paths) to **Radiative Transfer** (tracing energy).

### 3.1 The Radiative Transfer Equation (RTE)

Instead of alpha-blending surfaces, we integrate the RTE through the volumetric accretion disk:

$$ \frac{dI*\nu}{d\lambda} = j*\nu - \alpha*\nu I*\nu $$

- **Emission ($j_\nu$)**: Energy generated by the plasma.
- **Absorption ($\alpha_\nu$)**: Energy blocked by the plasma (self-shadowing).
- **Result**: Realistic "limb darkening" and optical depth transitions.

### 3.2 Spectral Radiance Transport (SPD)

To achieve PhD-level accuracy, we replace RGB color shifting with **Spectral Power Distribution (SPD)** transport.

1.  **Representation**: Light is modeled not as RGB, but as coefficients of **Gaussian Basis Functions** spanning 380nm - 780nm.
2.  **Relativistic Shift**:
    - Instead of shifting color $C' = C \cdot g$, we shift the entire spectral function $S'(\lambda) = S(\lambda / g)$.
    - This accurately models the "Searchlight Effect" where extreme blue-shift de-saturates colors into pure white intensity.
3.  **Human Perception**: The final shifted spectrum is integrated against **LMS Cone Fundamentals** (Long, Medium, Short) to produce a physiologically accurate color response.

---

## 4. Accretion Dynamics (Time-Domain)

The black hole environment is dynamic, not static.

### 4.1 Hot Spots

We inject localized Gaussian blobs of hotter plasma at the Innermost Stable Circular Orbit ($r_{ISCO}$).

- **Dynamics**: Blobs orbit at the local Keplerian frequency $\Omega_K = \sqrt{M}/(r^{3/2} + a\sqrt{M})$.
- **Visual**: Allows visualization of differential rotation and frame dragging.

### 4.2 Quasi-Periodic Oscillations (QPOs)

The disk intensity is modulated by resonant frequencies derived from the metric eigenmodes, simulating the flickering observed in real black hole data.

---

## 5. Relativistic Polarimetry <span style="color:red">**[EXPERIMENTAL]**</span>

Light acts as a vector wave. We solve the transport of the **Stokes Parameters** $(I, Q, U, V)$.

### 5.1 Gravitational Faraday Rotation

As light passes through the twisted spacetime (Frame Dragging), its polarization vector rotates.

- **Walker-Penrose Constant**: The kernel tracks the the complex scalar $\kappa_{WP}$ along the geodesic to maintain polarization consistency.
- **Visual**: Effectively visualizes the magnetic field lines of the black hole.

---

## 6. General Relativistic MHD <span style="color:red">**[EXPERIMENTAL]**</span>

We simulate the **turbulence** of the plasma, not just its density.

- **Curl-Noise Advection**: A divergence-free velocity field $\vec{v} = \nabla \times \vec{\psi}$ is generated on the GPU.
- **Relativistic Shear**: The field is sheared by the Keplerian velocity $\Omega_K$.
- **Result**: Dynamic formation of vortices, filaments, and "magnetic" flux tubes.

---

## 7. Optical Phenomena

### 5.1 The Photon Ring ("Edge of Infinity")

The visualization resolves the **Photon Ring** ($r \approx 3M$ to $r \approx M$), where light orbits the black hole multiple times.

- **Variable Rate Shading**: We deploy maximum compute density to this region to resolve the fractal self-similarity of the shadow border.

### 5.2 Lensing & Einstein Rings

Background stars are not just textures; they are point sources deflected by the lens equation.

- **Deflection**: Calculated via elliptic integrals (in Rust) or high-precision ray-marching (WebGPU).
- **Amplification**: Brightness is boosted by the lensing magnification factor $\mu$.

---

_References:_

1.  **Shakura, N. I., & Sunyaev, R. A. (1973)** - Standard Accretion Disk Model.
2.  **Luminet, J.-P. (1979)** - Image of a Spherical Black Hole with Thin Accretion Disk.
3.  **Fehlberg, E. (1969)** - Low-order classical Runge-Kutta formulas with stepsize control.
